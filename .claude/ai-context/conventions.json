{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "name": "MCH Conventions",
  "version": "2.0",

  "naming": {
    "files": {
      "pattern": "kebab-case",
      "examples": ["add-context.usecase.ts", "extract.service.ts"]
    },
    "classes": {
      "pattern": "PascalCase",
      "suffixes": {
        "usecase": "UseCase",
        "service": "Service",
        "adapter": "Adapter"
      },
      "examples": ["AddContextUseCase", "ExtractService", "ClaudeAdapter"]
    },
    "interfaces": {
      "pattern": "PascalCase",
      "prefixes": ["I (optional)", "none"],
      "examples": ["AIProvider", "StorageProvider", "Context"]
    },
    "functions": {
      "pattern": "camelCase",
      "examples": ["extractContext", "generateEmbedding"]
    },
    "constants": {
      "pattern": "SCREAMING_SNAKE_CASE",
      "examples": ["DEFAULT_SIMILARITY_THRESHOLD", "MAX_RESULTS"]
    }
  },

  "codeStyle": {
    "typescript": {
      "strict": true,
      "noImplicitAny": true,
      "preferInterfaces": true,
      "preferConst": true
    },
    "imports": {
      "order": ["node builtins", "external packages", "internal modules", "relative imports"],
      "style": "named imports preferred"
    },
    "exports": {
      "style": "named exports preferred",
      "indexFiles": "re-export public API"
    }
  },

  "errorHandling": {
    "baseClass": {
      "name": "MCHError",
      "extends": "Error",
      "properties": ["code: ErrorCode", "recoverable: boolean", "originalError?: Error"]
    },
    "errorClasses": {
      "pattern": "extends MCHError",
      "hierarchy": [
        "MCHError (base)",
        "AIError",
        "EmbeddingError",
        "StorageError",
        "TranscriptionError",
        "RecordingError",
        "ConfigError (with missingKeys[])",
        "InputError"
      ]
    },
    "errorCodes": {
      "pattern": "SCREAMING_SNAKE_CASE",
      "location": "src/types/errors.ts",
      "example": "ErrorCode.AI_RATE_LIMITED"
    },
    "recoveryMessages": {
      "format": "Record<ErrorCode, { ko: string; en: string }>",
      "location": "ERROR_RECOVERY in errors.ts",
      "usage": "error.getRecoveryMessage(language)"
    },
    "utilities": {
      "isMCHError(error)": "Type guard",
      "isRetryableError(error)": "Check if error should be retried",
      "detectErrorCode(error)": "Detect error code from raw error"
    }
  },

  "developmentStyle": {
    "method": "TDD (Test-Driven Development)",
    "cycle": ["RED (write failing test)", "GREEN (minimal code to pass)", "REFACTOR (clean up)"],
    "rules": [
      "No implementation without test first",
      "Tests describe expected behavior",
      "Mock external dependencies (AI API, DB)",
      "Small increments - repeat TDD cycle"
    ]
  },

  "internationalization": {
    "module": "src/i18n/",
    "functions": {
      "t": {
        "signature": "t(key: StringKey, lang: Language = 'ko'): string",
        "description": "Simple translation helper"
      },
      "ti": {
        "signature": "ti(key: StringKey, lang: Language, params: Record<string, string | number>): string",
        "description": "Translation with parameter interpolation"
      }
    },
    "languages": ["ko", "en"],
    "stringLocation": "src/i18n/strings.ts",
    "rules": [
      "Use t() for static strings",
      "Use ti() for strings with dynamic values",
      "String keys follow dot notation: 'scope.key' (e.g., 'menu.title', 'settings.language')"
    ]
  },

  "testing": {
    "framework": "vitest",
    "location": "*.test.ts alongside source files",
    "naming": {
      "pattern": "{name}.test.ts or {name}.test.tsx",
      "examples": ["extract.service.test.ts", "ErrorDisplay.test.tsx"]
    },
    "structure": "describe/it pattern",
    "mocking": "vi.mock for external dependencies",
    "coverage": {
      "required": ["services", "usecases"],
      "recommended": ["adapters", "components"]
    }
  },

  "commits": {
    "format": "type(scope): description",
    "types": ["feat", "fix", "refactor", "docs", "test", "chore"],
    "scopes": ["tui", "core", "adapters", "config"],
    "examples": [
      "feat(core): add context extraction service",
      "fix(tui): handle empty input state",
      "refactor(adapters): simplify storage interface"
    ]
  },

  "documentation": {
    "required": ["public interfaces", "complex logic"],
    "style": "JSDoc for public APIs, inline comments for complex logic",
    "language": "English for code, Korean for user-facing"
  }
}
